---
# tasks file for apache

- name: Update apt repo
  apt: 
    update_cache: yes

- name: install apache2
  apt: 
    name: apache2 
    state: latest

- name: install libxml2-dev
  apt: 
    name: libxml2-dev 
    state: latest

- apache2_module:
    state: present
    name: rewrite

- apache2_module:
    state: present
    name: proxy

- apache2_module:
    state: present
    name: proxy_balancer

- apache2_module:
    state: present
    name: proxy_http

- apache2_module:
    state: present
    name: headers

- apache2_module:
    state: present
    name: lbmethod_bytraffic

- name: start apache
  service:
      name: apache2
      state: started
  become: true

- name: copy 000-default.conf
  copy:
    src: ../files/000-default.conf
    dest: /etc/apache2/sites-available/000-default.conf

- name: restart apache
  service:
      name: apache2
      state: restarted
  become: true